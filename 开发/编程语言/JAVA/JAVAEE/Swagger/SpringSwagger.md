# ç®€ä»‹

Swaggeræ˜¯ä¸€ä¸ªåœ¨ç¼–å†™æ¥å£çš„æ—¶å€™è‡ªåŠ¨å¸®ä½ ç”Ÿæˆæ¥å£æ–‡æ¡£çš„ä¸œè¥¿ï¼Œåªè¦éµå¾ªå®ƒçš„è§„èŒƒå¹¶å†™ä¸€äº›æ¥å£çš„è¯´æ˜æ³¨è§£å³å¯ã€‚

## ä¼˜ç‚¹

- è‡ªåŠ¨ç”Ÿæˆæ–‡æ¡£ï¼Œåªéœ€è¦åœ¨æ¥å£ä¸­ä½¿ç”¨æ³¨è§£è¿›è¡Œæ ‡æ³¨ï¼Œå°±èƒ½ç”Ÿæˆå¯¹åº”çš„æ¥å£æ–‡æ¡£ã€‚
- è‡ªåŠ¨æ›´æ–°æ–‡æ¡£ï¼Œç”±äºæ˜¯åŠ¨æ€ç”Ÿæˆçš„ï¼Œæ‰€ä»¥å¦‚æœä½ ä¿®æ”¹äº†æ¥å£ï¼Œæ–‡æ¡£ä¹Ÿä¼šè‡ªåŠ¨å¯¹åº”ä¿®æ”¹ï¼ˆå¦‚æœä½ ä¹Ÿæ›´æ–°äº†æ³¨è§£çš„è¯ï¼‰ã€‚è¿™æ ·å°±ä¸ä¼šå‘é€æˆ‘ä¿®æ”¹äº†æ¥å£ï¼Œå´å¿˜è®°æ›´æ–°æ¥å£æ–‡æ¡£çš„æƒ…å†µã€‚
- æ”¯æŒåœ¨çº¿è°ƒè¯•ï¼Œswaggeræä¾›äº†åœ¨çº¿è°ƒç”¨æ¥å£çš„åŠŸèƒ½ã€‚

## ç¼ºç‚¹

- ä¸èƒ½åˆ›å»ºæµ‹è¯•ç”¨ä¾‹ï¼Œæ‰€ä»¥ä»–æš‚æ—¶ä¸èƒ½å¸®ä½ å¤„ç†å®Œæ‰€æœ‰çš„äº‹æƒ…ã€‚ä»–åªèƒ½æä¾›ä¸€ä¸ªç®€å•çš„åœ¨çº¿è°ƒè¯•ï¼Œå¦‚æœä½ æƒ³å­˜å‚¨ä½ çš„æµ‹è¯•ç”¨ä¾‹ï¼Œå¯ä»¥ä½¿ç”¨Postmanæˆ–è€…YAPIè¿™æ ·æ”¯æŒåˆ›å»ºæµ‹è¯•ç”¨æˆ·çš„åŠŸèƒ½ã€‚
- è¦éµå¾ªä¸€äº›è§„èŒƒï¼Œå®ƒä¸æ˜¯ä»»æ„è§„èŒƒçš„ã€‚æ¯”å¦‚è¯´ï¼Œä½ å¯èƒ½ä¼šè¿”å›ä¸€ä¸ªjsonæ•°æ®ï¼Œè€Œè¿™ä¸ªæ•°æ®å¯èƒ½æ˜¯ä¸€ä¸ªMapæ ¼å¼çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ­¤æ—¶ä¸èƒ½æ ‡æ³¨è¿™ä¸ªMapæ ¼å¼çš„è¿”å›æ•°æ®çš„æ¯ä¸ªå­—æ®µçš„è¯´æ˜ï¼Œè€Œå¦‚æœå®ƒæ˜¯ä¸€ä¸ªå®ä½“ç±»çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ ‡æ³¨ç±»çš„å±æ€§æ¥ç»™è¿”å›å­—æ®µåŠ è¯´æ˜ã€‚ä¹Ÿæ¯”å¦‚è¯´ï¼Œå¯¹äºswaggerï¼Œä¸æ¨èåœ¨ä½¿ç”¨GETæ–¹å¼æäº¤æ•°æ®çš„æ—¶å€™è¿˜ä½¿ç”¨Bodyï¼Œä»…æ¨èä½¿ç”¨queryå‚æ•°ã€headerå‚æ•°æˆ–è€…è·¯å¾„å‚æ•°ï¼Œå½“ç„¶äº†è¿™ä¸ªé™åˆ¶åªé€‚ç”¨äºåœ¨çº¿è°ƒè¯•ã€‚
- æ²¡æœ‰æ¥å£æ–‡æ¡£æ›´æ–°ç®¡ç†ï¼Œè™½ç„¶ä¸€ä¸ªæ¥å£æ›´æ–°ä¹‹åï¼Œå¯èƒ½ä¸ä¼šå…³å¿ƒæ—§ç‰ˆçš„æ¥å£ä¿¡æ¯ï¼Œä½†ä½ â€œå¯èƒ½â€æƒ³çœ‹çœ‹æ—§ç‰ˆçš„æ¥å£ä¿¡æ¯ï¼Œä¾‹å¦‚æœ‰äº›ç°åº¦æ›´æ–°å‘å¸ƒçš„æ—¶å€™å¯èƒ½è¿˜ä¼šå…³å¿ƒæ—§ç‰ˆçš„æ¥å£ã€‚é‚£ä¹ˆæ­¤æ—¶åªèƒ½ç”±åç«¯å»çœ‹çœ‹æœ‰æ²¡æœ‰æ³¨é‡Šç•™ä¸‹äº†ï¼Œæ‰€ä»¥å¯ä»¥è€ƒè™‘æ¥å£æ–‡æ¡£å¤§æ›´æ–°çš„æ—¶å€™æ³¨é‡Šæ—§ç‰ˆçš„ï¼Œç„¶åå†™ä¸‹æ–°ç‰ˆçš„ã€‚ã€å½“ç„¶è¿™ä¸ªé—®é¢˜å¯ä»¥é€šè¿‡å¯¼å‡ºæ¥å£æ–‡æ¡£æ¥å¯¹æ¯”ã€‚ã€‘
- è™½ç„¶ç°åœ¨Javaçš„å®ä½“ç±»ä¸­æœ‰ä¸å°‘æ¨¡å‹ï¼Œpo,dto,voç­‰ï¼Œæ¨¡å‹çš„åŒºåˆ†æ˜¯ä¸ºäº†å±è”½ä¸€äº›å¤šä½™å‚æ•°ï¼Œæ¯”å¦‚ä¸€ä¸ªç”¨æˆ·ç™»å½•çš„æ—¶å€™åªéœ€è¦username,passwordï¼Œä½†æŸ¥æƒé™çš„æ—¶å€™éœ€è¦è¿æ¥ä¸Šæƒé™è¡¨çš„ä¿¡æ¯ï¼Œè€Œå¦‚æœä¸Šè¿°ä¸¤ä¸ªæ“ä½œéƒ½æ˜¯ä½¿ç”¨äº†Userè¿™ä¸ªå®ä½“çš„è¯ï¼Œåœ¨æ–‡æ¡£ä¸­å°±ä¼šè‡ªåŠ¨ç”Ÿæˆäº†å¤šä½™çš„ä¿¡æ¯ï¼Œè¿™å°±è¦æ±‚äº†ä½ åŸºäºæ¨¡å‹æ¥åˆ›å»ºå¤šä¸ªå®ä½“ç±»ï¼Œæ¯”å¦‚ç™»å½•çš„æ—¶å€™ä¸€ä¸ªLoginFormï¼Œéœ€è¦ç”¨æˆ·-æƒé™ç­‰ä¿¡æ¯çš„æ—¶å€™æ‰ä½¿ç”¨Userç±»ã€‚ï¼ˆå½“ç„¶äº†ï¼Œè¿™ä¸ªé—®é¢˜ç­‰ä½ ä¼šswaggerä¹‹åä½ å°±å¤§æ¦‚å°±ä¼šæ€ä¹ˆè§„é¿è¿™ä¸ªé—®é¢˜äº†ã€‚ï¼‰

# æ·»åŠ swaggerè¿›å…¥é¡¹ç›®
## æ·»åŠ ä¾èµ–åŒ…

>è¿™é‡Œçš„å‰ææ˜¯å·²ç»å¯¼å…¥äº†spring bootçš„webåŒ…ã€‚

```xml
        <dependency>
            <groupId>io.springfox</groupId>
            <artifactId>springfox-swagger2</artifactId>
            <version>2.9.2</version>
        </dependency>
        <dependency>
            <groupId>io.springfox</groupId>
            <artifactId>springfox-swagger-ui</artifactId>
            <version>2.9.2</version>
        </dependency>
```

## é…ç½®swagger
è¦ä½¿ç”¨swaggerï¼Œé¦–å…ˆéœ€è¦åˆ›å»ºä¸€ä¸ªswaggeré…ç½®ç±»å¯¹å®ƒè¿›è¡Œé…ç½®ã€‚

```java
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import springfox.documentation.builders.ApiInfoBuilder;
import springfox.documentation.builders.PathSelectors;
import springfox.documentation.builders.RequestHandlerSelectors;
import springfox.documentation.service.ApiInfo;
import springfox.documentation.spi.DocumentationType;
import springfox.documentation.spring.web.plugins.Docket;
import springfox.documentation.swagger2.annotations.EnableSwagger2;


@Configuration // æ ‡æ˜æ˜¯é…ç½®ç±»
@EnableSwagger2 //å¼€å¯swaggeråŠŸèƒ½
public class SwaggerConfig {
    @Bean
    public Docket createRestApi() {
        return new Docket(DocumentationType.SWAGGER_2)  // DocumentationType.SWAGGER_2 å›ºå®šçš„ï¼Œä»£è¡¨swagger2
//                .groupName("åˆ†å¸ƒå¼ä»»åŠ¡ç³»ç»Ÿ") // å¦‚æœé…ç½®å¤šä¸ªæ–‡æ¡£çš„æ—¶å€™ï¼Œé‚£ä¹ˆéœ€è¦é…ç½®groupNameæ¥åˆ†ç»„æ ‡è¯†
                .apiInfo(apiInfo()) // ç”¨äºç”ŸæˆAPIä¿¡æ¯
                .select() // select()å‡½æ•°è¿”å›ä¸€ä¸ªApiSelectorBuilderå®ä¾‹,ç”¨æ¥æ§åˆ¶æ¥å£è¢«swaggeråšæˆæ–‡æ¡£
                .apis(RequestHandlerSelectors.basePackage("com.example.springswagger")) // ç”¨äºæŒ‡å®šæ‰«æå“ªä¸ªåŒ…ä¸‹çš„æ¥å£
                .paths(PathSelectors.any())// é€‰æ‹©æ‰€æœ‰çš„API,å¦‚æœä½ æƒ³åªä¸ºéƒ¨åˆ†APIç”Ÿæˆæ–‡æ¡£ï¼Œå¯ä»¥é…ç½®è¿™é‡Œ
                .build();
    }

    /**
     * ç”¨äºå®šä¹‰APIä¸»ç•Œé¢çš„ä¿¡æ¯ï¼Œæ¯”å¦‚å¯ä»¥å£°æ˜æ‰€æœ‰çš„APIçš„æ€»æ ‡é¢˜ã€æè¿°ã€ç‰ˆæœ¬
     * @return
     */
    private ApiInfo apiInfo() {
        return new ApiInfoBuilder()
                .title("Testé¡¹ç›®API") //  å¯ä»¥ç”¨æ¥è‡ªå®šä¹‰APIçš„ä¸»æ ‡é¢˜
                .description("Testé¡¹ç›®SwaggerAPIç®¡ç†") // å¯ä»¥ç”¨æ¥æè¿°æ•´ä½“çš„API
                .termsOfServiceUrl("") // ç”¨äºå®šä¹‰æœåŠ¡çš„åŸŸå
                .version("1.0") // å¯ä»¥ç”¨æ¥å®šä¹‰ç‰ˆæœ¬ã€‚
                .build(); //
    }
}
```

## æµ‹è¯•
è¿è¡Œæˆ‘ä»¬çš„Spring Booté¡¹ç›®ï¼Œï¼ˆæˆ‘é»˜è®¤æ˜¯8080ç«¯å£ï¼Œå¦‚æœä½ ä¸ä¸€æ ·ï¼Œè¯·æ³¨æ„ä¿®æ”¹åç»­çš„urlï¼‰ï¼Œè®¿é—® http://localhost:8080/swagger-ui.html

ç„¶åä½ å°±å¯ä»¥çœ‹åˆ°ä¸€ä¸ªå¦‚ä¸‹çš„ç•Œé¢ï¼Œç”±äºæˆ‘ä»¬æš‚æ—¶æ²¡æœ‰é…ç½®æ¥å£æ•°æ®ï¼Œæ‰€ä»¥ä¸‹é¢æ˜¾ç¤ºNo operations defined in spec!

![](./img/swaggeræµ‹è¯•æ‰“å¼€ç•Œé¢.png)

# ä½¿ç”¨åœºæ™¯
## å®šä¹‰æ¥å£ç»„

æ¥å£æœ‰æ—¶å€™åº”è¯¥æ˜¯åˆ†ç»„çš„ï¼Œè€Œä¸”å¤§éƒ¨åˆ†éƒ½æ˜¯åœ¨ä¸€ä¸ª controller ä¸­çš„ï¼Œæ¯”å¦‚ç”¨æˆ·ç®¡ç†ç›¸å…³çš„æ¥å£åº”è¯¥éƒ½åœ¨ UserController ä¸­ï¼Œé‚£ä¹ˆä¸åŒçš„ä¸šåŠ¡çš„æ—¶å€™ï¼Œåº”è¯¥å®šä¹‰/åˆ’åˆ†ä¸åŒçš„æ¥å£ç»„ã€‚æ¥å£ç»„å¯ä»¥ä½¿ç”¨ `@Api` æ¥åˆ’åˆ†ã€‚
æ¯”å¦‚ï¼š

```java
@Api(tags = "è§’è‰²ç®¡ç†") //å¯ä»¥å½“ä½œæ˜¯è¿™ä¸ªç»„çš„åå­—ã€‚
@RestController
public class RoleController {
}
```

å’Œ

```java
@Api(tags = "ç”¨æˆ·ç®¡ç†") //å¯ä»¥å½“ä½œæ˜¯è¿™ä¸ªç»„çš„åå­—ã€‚
@RestController
public class UserController {
}
```

- ä½ ä¹Ÿå¯ä»¥ç†è§£æˆåŸºäºtagsæ¥åˆ†ç»„ï¼Œå°±å¥½åƒä¸€äº›æ–‡ç« é‡Œé¢çš„æ ‡ç­¾ä¸€æ ·ï¼Œä½¿ç”¨æ ‡ç­¾æ¥åˆ†ç±»ã€‚
- å¦‚æœè¿™ä¸ªControllerä¸‹ï¼ˆæ¥å£ç»„ï¼‰ä¸‹é¢æ²¡æœ‰æ¥å£ï¼Œé‚£ä¹ˆåœ¨swagger uiä¸­æ˜¯ä¸ä¼šæ˜¾ç¤ºçš„ï¼Œå¦‚æœæœ‰çš„è¯å°±ä¼šè¿™æ ·æ˜¾ç¤ºï¼š

![](img/Swaggeré¡µé¢è§£é‡Š-00.png)

## å®šä¹‰æ¥å£

ä½¿ç”¨äº†@Apiæ¥æ ‡æ³¨ä¸€ä¸ªControllerä¹‹åï¼Œå¦‚æœä¸‹é¢æœ‰æ¥å£ï¼Œé‚£ä¹ˆå°±ä¼šé»˜è®¤ç”Ÿæˆæ–‡æ¡£ï¼Œä½†æ²¡æœ‰æˆ‘ä»¬è‡ªå®šä¹‰çš„è¯´æ˜ï¼š

```java
@Api(tags = "ç”¨æˆ·ç®¡ç†")
@RestController
public class UserController {
    // æ³¨æ„ï¼Œå¯¹äºswaggerï¼Œä¸è¦ä½¿ç”¨@RequestMappingï¼Œ
    // å› ä¸º@RequestMappingæ”¯æŒä»»æ„è¯·æ±‚æ–¹å¼ï¼Œswaggerä¼šä¸ºè¿™ä¸ªæ¥å£ç”Ÿæˆ7ç§è¯·æ±‚æ–¹å¼çš„æ¥å£æ–‡æ¡£
    @GetMapping("/info") 
    public String info(String id){
        return "aaa";
    }
}
```

![](img/Swaggeré¡µé¢è§£é‡Š-01.png)
![](img/Swaggeré¡µé¢è§£é‡Š-02.png)

å¯ä»¥ä½¿ç”¨`@ApiOperation`æ¥æè¿°æ¥å£ï¼Œæ¯”å¦‚ï¼š

```java
    @ApiOperation(value = "ç”¨æˆ·æµ‹è¯•",notes = "ç”¨æˆ·æµ‹è¯•notes")
    @GetMapping("/test")
    public String test(String id){
        return "test";
    }
```

![](img/Swaggeré¡µé¢è§£é‡Š-03.png)

å¸¸ç”¨é…ç½®é¡¹ï¼š

- valueï¼šå¯ä»¥å½“ä½œæ˜¯æ¥å£çš„ç®€ç§°
- notesï¼šæ¥å£çš„æè¿°
- tagsï¼šå¯ä»¥é¢å¤–å®šä¹‰æ¥å£ç»„ï¼Œæ¯”å¦‚è¿™ä¸ªæ¥å£å¤–å±‚å·²ç»æœ‰ `@Api(tags = "ç”¨æˆ·ç®¡ç†")` ï¼Œå°†æ¥å£åˆ’åˆ†åˆ°äº†â€œç”¨æˆ·ç®¡ç†â€ä¸­ï¼Œä½†ä½ å¯ä»¥é¢å¤–çš„ä½¿ç”¨tagsï¼Œä¾‹å¦‚ `tags = "è§’è‰²ç®¡ç†"` è®©è§’è‰²ç®¡ç†ä¸­ä¹Ÿæœ‰è¿™ä¸ªæ¥å£æ–‡æ¡£ã€‚

## å®šä¹‰æ¥å£è¯·æ±‚å‚æ•°
ä¸Šé¢ä½¿ç”¨äº†`@ApiOperation`æ¥äº†æè¿°æ¥å£ï¼Œä½†å…¶å®è¿˜ç¼ºå°‘æ¥å£è¯·æ±‚å‚æ•°çš„è¯´æ˜ï¼Œä¸‹é¢åˆ†åœºæ™¯æ¥è®²ã€‚

- æ³¨æ„ä¸€ä¸‹ï¼Œ**å¯¹äºGETæ–¹å¼ï¼Œswaggerä¸æ¨èä½¿ç”¨bodyæ–¹å¼æ¥ä¼ é€’æ•°æ®**ï¼Œä¹Ÿå°±æ˜¯ä¸å¸Œæœ›åœ¨GETæ–¹å¼æ—¶ä½¿ç”¨jsonã€form-dataç­‰æ–¹å¼æ¥ä¼ é€’ï¼Œè¿™æ—¶å€™æœ€å¥½ä½¿ç”¨è·¯å¾„å‚æ•°æˆ–è€…urlå‚æ•°ã€‚(ğŸ˜“è™½ç„¶POSTMANç­‰æ˜¯æ”¯æŒçš„)ï¼Œæ‰€ä»¥å¦‚æœæ¥å£ä¼ é€’çš„æ•°æ®æ˜¯jsonæˆ–è€…form-dataæ–¹å¼çš„ï¼Œè¿˜æ˜¯ä½¿ç”¨POSTæ–¹å¼å¥½ã€‚

### åœºæ™¯ä¸€ï¼šè¯·æ±‚å‚æ•°æ˜¯å®ä½“ç±»
æ­¤æ—¶æˆ‘ä»¬éœ€è¦ä½¿ç”¨`@ApiModel`æ¥æ ‡æ³¨å®ä½“ç±»ï¼Œç„¶ååœ¨æ¥å£ä¸­å®šä¹‰å…¥å‚ä¸ºå®ä½“ç±»å³å¯ï¼š

@ApiModelï¼šç”¨æ¥æ ‡ç±»
- å¸¸ç”¨é…ç½®é¡¹ï¼š
  - valueï¼šå®ä½“ç±»ç®€ç§°
  - descriptionï¼šå®ä½“ç±»è¯´æ˜

@ApiModelPropertyï¼šç”¨æ¥æè¿°ç±»çš„å­—æ®µçš„æ„ä¹‰ã€‚
- å¸¸ç”¨é…ç½®é¡¹ï¼š
  - valueï¼šå­—æ®µè¯´æ˜
  - exampleï¼šè®¾ç½®è¯·æ±‚ç¤ºä¾‹ï¼ˆExample Valueï¼‰çš„é»˜è®¤å€¼ï¼Œå¦‚æœä¸é…ç½®ï¼Œå½“å­—æ®µä¸ºstringçš„æ—¶å€™ï¼Œæ­¤æ—¶è¯·æ±‚ç¤ºä¾‹ä¸­é»˜è®¤å€¼ä¸º"".
  - nameï¼šç”¨æ–°çš„å­—æ®µåæ¥æ›¿ä»£æ—§çš„å­—æ®µåã€‚
  - allowableValuesï¼šé™åˆ¶å€¼å¾—èŒƒå›´ï¼Œä¾‹å¦‚`{1,2,3}`ä»£è¡¨åªèƒ½å–è¿™ä¸‰ä¸ªå€¼ï¼›`[1,5]`ä»£è¡¨å–1åˆ°5çš„å€¼ï¼›`(1,5)`ä»£è¡¨1åˆ°5çš„å€¼ï¼Œä¸åŒ…æ‹¬1å’Œ5ï¼›è¿˜å¯ä»¥ä½¿ç”¨infinityæˆ–-infinityæ¥æ— é™å€¼ï¼Œæ¯”å¦‚`[1, infinity]`ä»£è¡¨æœ€å°å€¼ä¸º1ï¼Œæœ€å¤§å€¼æ— ç©·å¤§ã€‚
  - requiredï¼šæ ‡è®°å­—æ®µæ˜¯å¦å¿…å¡«ï¼Œé»˜è®¤æ˜¯false,
  - hiddenï¼šç”¨æ¥éšè—å­—æ®µï¼Œé»˜è®¤æ˜¯falseï¼Œå¦‚æœè¦éšè—éœ€è¦ä½¿ç”¨trueï¼Œå› ä¸ºå­—æ®µé»˜è®¤éƒ½ä¼šæ˜¾ç¤ºï¼Œå°±ç®—æ²¡æœ‰`@ApiModelProperty`ã€‚

```java
// å…ˆä½¿ç”¨@ApiModelæ¥æ ‡æ³¨ç±»
@ApiModel(value="ç”¨æˆ·ç™»å½•è¡¨å•å¯¹è±¡",description="ç”¨æˆ·ç™»å½•è¡¨å•å¯¹è±¡")
public class LoginForm {
    // ä½¿ç”¨ApiModelPropertyæ¥æ ‡æ³¨å­—æ®µå±æ€§ã€‚
    @ApiModelProperty(value = "ç”¨æˆ·å",required = true,example = "root")
    private String username;
    @ApiModelProperty(value = "å¯†ç ",required = true,example = "123456")
    private String password;

    // æ­¤å¤„çœç•¥å…¥å‚èµ‹å€¼æ—¶éœ€è¦çš„getter,setter,swaggerä¹Ÿéœ€è¦è¿™ä¸ª
}
```

å®šä¹‰æˆå…¥å‚ï¼š

```java
    @ApiOperation(value = "ç™»å½•æ¥å£",notes = "ç™»å½•æ¥å£çš„è¯´æ˜")
    @PostMapping("/login")
    public LoginForm login(@RequestBody LoginForm loginForm){
        return loginForm;
    }
```

![](img/Swaggeré¡µé¢è§£é‡Š-04.png)

### åœºæ™¯äºŒï¼šè¯·æ±‚å‚æ•°æ˜¯éå®ä½“ç±»
ï¼ˆå†è¯´ä¸€æ¬¡ï¼šå¯¹äºGETæ–¹å¼ï¼Œswaggerä¸æ¨èä½¿ç”¨bodyæ–¹å¼æ¥ä¼ é€’æ•°æ®ï¼Œæ‰€ä»¥è™½ç„¶Spring MVCå¯ä»¥è‡ªåŠ¨å°è£…å‚æ•°ï¼Œä½†å¯¹äºGETè¯·æ±‚è¿˜æ˜¯ä¸è¦ä½¿ç”¨form-dataï¼Œjsonç­‰æ–¹å¼ä¼ é€’å‚æ•°ï¼Œé™¤éä½ ä½¿ç”¨Postmanæ¥æµ‹è¯•æ¥å£ï¼Œswaggeråœ¨çº¿æµ‹è¯•æ˜¯ä¸æ”¯æŒè¿™ä¸ªæ“ä½œçš„ï¼‰

å¯¹äºéå®ä½“ç±»å‚æ•°ï¼Œå¯ä»¥ä½¿ç”¨`@ApiImplicitParams`å’Œ`@ApiImplicitParam`æ¥å£°æ˜è¯·æ±‚å‚æ•°ã€‚
`@ApiImplicitParams`ç”¨åœ¨æ–¹æ³•å¤´ä¸Šï¼Œ`@ApiImplicitParam`å®šä¹‰åœ¨`@ApiImplicitParams`é‡Œé¢ï¼Œä¸€ä¸ª`@ApiImplicitParam`å¯¹åº”ä¸€ä¸ªå‚æ•°ã€‚

`@ApiImplicitParam`å¸¸ç”¨é…ç½®é¡¹:

- nameï¼šç”¨æ¥å®šä¹‰å‚æ•°çš„åå­—ï¼Œä¹Ÿå°±æ˜¯å­—æ®µçš„åå­—,å¯ä»¥ä¸æ¥å£çš„å…¥å‚åå¯¹åº”ã€‚å¦‚æœä¸å¯¹åº”ï¼Œä¹Ÿä¼šç”Ÿæˆï¼Œæ‰€ä»¥å¯ä»¥ç”¨æ¥å®šä¹‰é¢å¤–å‚æ•°ï¼
- valueï¼šç”¨æ¥æè¿°å‚æ•°
- requiredï¼šç”¨æ¥æ ‡æ³¨å‚æ•°æ˜¯å¦å¿…å¡«
- paramTypeæœ‰path,query,body,form,headerç­‰æ–¹å¼ï¼Œä½†å¯¹äºå¯¹äºéå®ä½“ç±»å‚æ•°çš„æ—¶å€™ï¼Œå¸¸ç”¨çš„åªæœ‰path,query,headerï¼›bodyå’Œformæ˜¯ä¸å¸¸ç”¨çš„ã€‚bodyä¸é€‚ç”¨äºå¤šä¸ªé›¶æ•£å‚æ•°çš„æƒ…å†µï¼Œåªé€‚ç”¨äºjsonå¯¹è±¡ç­‰æƒ…å†µã€‚(å¦‚æœæ¥å£æ˜¯`form-data`,`x-www-form-urlencoded`çš„æ—¶å€™å¯èƒ½ä¸èƒ½ä½¿ç”¨swaggeré¡µé¢APIè°ƒè¯•ï¼Œä½†å¯ä»¥åœ¨åé¢è®²åˆ°åŸºäºBootstrapUIçš„swaggerå¢å¼ºä¸­è°ƒè¯•ï¼ŒåŸºäºBootstrapUIçš„swaggeræ”¯æŒæŒ‡å®š`form-data`æˆ–`x-www-form-urlencoded`)

ç¤ºä¾‹ä¸€ï¼šå£°æ˜å…¥å‚æ˜¯URLå‚æ•°

```java
  // ä½¿ç”¨URL queryå‚æ•°
    @ApiOperation(value = "ç™»å½•æ¥å£2",notes = "ç™»å½•æ¥å£çš„è¯´æ˜2")
    @ApiImplicitParams({
            @ApiImplicitParam(name = "username",//å‚æ•°åå­—
                    value = "ç”¨æˆ·å",//å‚æ•°çš„æè¿°
                    required = true,//æ˜¯å¦å¿…é¡»ä¼ å…¥
                    //paramTypeå®šä¹‰å‚æ•°ä¼ é€’ç±»å‹ï¼šæœ‰path,query,body,form,header
                    paramType = "query"
                    )
            ,
            @ApiImplicitParam(name = "password",//å‚æ•°åå­—
                    value = "å¯†ç ",//å‚æ•°çš„æè¿°
                    required = true,//æ˜¯å¦å¿…é¡»ä¼ å…¥
                    paramType = "query"
                    )
    })
    @PostMapping(value = "/login2")
    public LoginForm login2(String username,String password){
        System.out.println(username+":"+password);
        LoginForm loginForm = new LoginForm();
        loginForm.setUsername(username);
        loginForm.setPassword(password);
        return loginForm;
    }
```

ç¤ºä¾‹äºŒï¼šå£°æ˜å…¥å‚æ˜¯URLè·¯å¾„å‚æ•°

```java
    // ä½¿ç”¨è·¯å¾„å‚æ•°
    @PostMapping("/login3/{id1}/{id2}")
    @ApiOperation(value = "ç™»å½•æ¥å£3",notes = "ç™»å½•æ¥å£çš„è¯´æ˜3")
    @ApiImplicitParams({
            @ApiImplicitParam(name = "id1",//å‚æ•°åå­—
                    value = "ç”¨æˆ·å",//å‚æ•°çš„æè¿°
                    required = true,//æ˜¯å¦å¿…é¡»ä¼ å…¥
                    //paramTypeå®šä¹‰å‚æ•°ä¼ é€’ç±»å‹ï¼šæœ‰path,query,body,form,header
                    paramType = "path"
            )
            ,
            @ApiImplicitParam(name = "id2",//å‚æ•°åå­—
                    value = "å¯†ç ",//å‚æ•°çš„æè¿°
                    required = true,//æ˜¯å¦å¿…é¡»ä¼ å…¥
                    paramType = "path"
            )
    })
    public String login3(@PathVariable Integer id1,@PathVariable Integer id2){
        return id1+":"+id2;
    }
```

ç¤ºä¾‹ä¸‰ï¼šå£°æ˜å…¥å‚æ˜¯headerå‚æ•°

```java
    // ç”¨headerä¼ é€’å‚æ•°
    @PostMapping("/login4")
    @ApiOperation(value = "ç™»å½•æ¥å£4",notes = "ç™»å½•æ¥å£çš„è¯´æ˜4")
    @ApiImplicitParams({
            @ApiImplicitParam(name = "username",//å‚æ•°åå­—
                    value = "ç”¨æˆ·å",//å‚æ•°çš„æè¿°
                    required = true,//æ˜¯å¦å¿…é¡»ä¼ å…¥
                    //paramTypeå®šä¹‰å‚æ•°ä¼ é€’ç±»å‹ï¼šæœ‰path,query,body,form,header
                    paramType = "header"
            )
            ,
            @ApiImplicitParam(name = "password",//å‚æ•°åå­—
                    value = "å¯†ç ",//å‚æ•°çš„æè¿°
                    required = true,//æ˜¯å¦å¿…é¡»ä¼ å…¥
                    paramType = "header"
            )
    })
    public String login4( @RequestHeader String username,
                          @RequestHeader String password){
        return username+":"+password;
    }
```

ç¤ºä¾‹å››ï¼šå£°æ˜æ–‡ä»¶ä¸Šä¼ å‚æ•°

```java
    // æœ‰æ–‡ä»¶ä¸Šä¼ æ—¶è¦ç”¨@ApiParamï¼Œç”¨æ³•åŸºæœ¬ä¸@ApiImplicitParamä¸€æ ·ï¼Œä¸è¿‡@ApiParamç”¨åœ¨å‚æ•°ä¸Š
    // æˆ–è€…ä½ ä¹Ÿå¯ä»¥ä¸æ³¨è§£ï¼Œswaggerä¼šè‡ªåŠ¨ç”Ÿæˆè¯´æ˜
    @ApiOperation(value = "ä¸Šä¼ æ–‡ä»¶",notes = "ä¸Šä¼ æ–‡ä»¶")
    @PostMapping(value = "/upload")
    public String upload(@ApiParam(value = "å›¾ç‰‡æ–‡ä»¶", required = true)MultipartFile uploadFile){
        String originalFilename = uploadFile.getOriginalFilename();

        return originalFilename;
    }
    

    // å¤šä¸ªæ–‡ä»¶ä¸Šä¼ æ—¶ï¼Œ**swaggeråªèƒ½æµ‹è¯•å•æ–‡ä»¶ä¸Šä¼ **
    @ApiOperation(value = "ä¸Šä¼ å¤šä¸ªæ–‡ä»¶",notes = "ä¸Šä¼ å¤šä¸ªæ–‡ä»¶")
    @PostMapping(value = "/upload2",consumes = "multipart/*", headers = "content-type=multipart/form-data")
    public String upload2(@ApiParam(value = "å›¾ç‰‡æ–‡ä»¶", required = true,allowMultiple = true)MultipartFile[] uploadFile){
        StringBuffer sb = new StringBuffer();
        for (int i = 0; i < uploadFile.length; i++) {
            System.out.println(uploadFile[i].getOriginalFilename());
            sb.append(uploadFile[i].getOriginalFilename());
            sb.append(",");
        }
        return sb.toString();
    }



    // æ—¢æœ‰æ–‡ä»¶ï¼Œåˆæœ‰å‚æ•°
    @ApiOperation(value = "æ—¢æœ‰æ–‡ä»¶ï¼Œåˆæœ‰å‚æ•°",notes = "æ—¢æœ‰æ–‡ä»¶ï¼Œåˆæœ‰å‚æ•°")
    @PostMapping(value = "/upload3")
    @ApiImplicitParams({
            @ApiImplicitParam(name = "name",
                    value = "å›¾ç‰‡æ–°åå­—",
                    required = true
            )
    })
    public String upload3(@ApiParam(value = "å›¾ç‰‡æ–‡ä»¶", required = true)MultipartFile uploadFile,
                          String name){
        String originalFilename = uploadFile.getOriginalFilename();

        return originalFilename+":"+name;
    }
```

## å®šä¹‰æ¥å£å“åº”
å®šä¹‰æ¥å£å“åº”ï¼Œæ˜¯æ–¹ä¾¿æŸ¥çœ‹æ¥å£æ–‡æ¡£çš„äººèƒ½å¤ŸçŸ¥é“æ¥å£è¿”å›çš„æ•°æ®çš„æ„ä¹‰ã€‚

### å“åº”æ˜¯å®ä½“ç±»
å‰é¢åœ¨å®šä¹‰æ¥å£è¯·æ±‚å‚æ•°çš„æ—¶å€™æœ‰æåˆ°ä½¿ç”¨`@ApiModel`æ¥æ ‡æ³¨ç±»ï¼Œå¦‚æœæ¥å£è¿”å›äº†è¿™ä¸ªç±»ï¼Œé‚£ä¹ˆè¿™ä¸ªç±»ä¸Šçš„è¯´æ˜ä¹Ÿä¼šä½œä¸ºå“åº”çš„è¯´æ˜ï¼š

```java
   // è¿”å›è¢«@ApiModelæ ‡æ³¨çš„ç±»å¯¹è±¡
    @ApiOperation(value = "å®ä½“ç±»å“åº”",notes = "è¿”å›æ•°æ®ä¸ºå®ä½“ç±»çš„æ¥å£")
    @PostMapping("/role1")
    public LoginForm role1(@RequestBody LoginForm loginForm){
        return loginForm;
    }
```

![](img/Swaggeré¡µé¢è§£é‡Š-05.png)

### å“åº”æ˜¯éå®ä½“ç±»
swaggeræ— æ³•å¯¹éå®ä½“ç±»çš„å“åº”è¿›è¡Œè¯¦ç»†è¯´æ˜ï¼Œåªèƒ½æ ‡æ³¨å“åº”ç ç­‰ä¿¡æ¯ã€‚æ˜¯é€šè¿‡`@ApiResponses`å’Œ`@ApiResponse`æ¥å®ç°çš„ã€‚

`@ApiResponses`å’Œ`@ApiResponse`å¯ä»¥ä¸`@ApiModel`ä¸€èµ·ä½¿ç”¨ã€‚

```java
  // å…¶ä»–ç±»å‹çš„,æ­¤æ—¶ä¸èƒ½å¢åŠ å­—æ®µæ³¨é‡Šï¼Œæ‰€ä»¥å…¶å®swaggeræ¨èä½¿ç”¨å®ä½“ç±»
    @ApiOperation(value = "éå®ä½“ç±»",notes = "éå®ä½“ç±»")
    @ApiResponses({
            @ApiResponse(code=200,message = "è°ƒç”¨æˆåŠŸ"),
            @ApiResponse(code=401,message = "æ— æƒé™" )
    }
    )
    @PostMapping("/role2")
    public String role2(){
        return " {\n" +
                " name:\"å¹¿ä¸œ\",\n" +
                "     citys:{\n" +
                "         city:[\"å¹¿å·\",\"æ·±åœ³\",\"ç æµ·\"]\n" +
                "     }\n" +
                " }";
    }
```

![](img/Swaggeré¡µé¢è§£é‡Š-06.png)

# Swagger UIå¢å¼º
æœ‰ä¸€äº›ç¬¬ä¸‰æ–¹æä¾›äº†ä¸€äº›Swagger UIå¢å¼ºï¼Œæ¯”è¾ƒæµè¡Œçš„æ˜¯`swagger-bootstrap-ui`ï¼Œæˆ‘ä»¬è¿™é‡Œä»¥`swagger-bootstrap-ui`ä¸ºä¾‹ã€‚

å¯¹æ¯”:

![](img/SwaggerUIå¯¹æ¯”-01.png)
![](img/SwaggerUIå¯¹æ¯”-02.png)

## ä½¿ç”¨
æ·»åŠ ä¾èµ–

```xml
        <!--å¼•å…¥swagger-->
        <dependency>
            <groupId>io.springfox</groupId>
            <artifactId>springfox-swagger2</artifactId>
            <version>2.9.2</version>
        </dependency>
        <dependency>
            <groupId>io.springfox</groupId>
            <artifactId>springfox-swagger-ui</artifactId>
            <version>2.9.2</version>
        </dependency>
        <!-- å¼•å…¥swagger-bootstrap-uiä¾èµ–åŒ…-->
        <dependency>
            <groupId>com.github.xiaoymin</groupId>
            <artifactId>swagger-bootstrap-ui</artifactId>
            <version>1.8.7</version>
        </dependency>
```

åœ¨swaggeré…ç½®ç±»ä¸­å¢åŠ æ³¨è§£`@EnableSwaggerBootstrapUI`:

```java
@Configuration // æ ‡æ˜æ˜¯é…ç½®ç±»
@EnableSwagger2 //å¼€å¯swaggeråŠŸèƒ½
@EnableSwaggerBootstrapUI // å¼€å¯SwaggerBootstrapUI
public class SwaggerConfig {
    // çœç•¥é…ç½®å†…å®¹
}
```

è®¿é—®APIï¼šhttp://localhost:8080/doc.htmlï¼Œå³å¯é¢„è§ˆåˆ°åŸºäºbootstarpçš„Swagger UIç•Œé¢ã€‚

## ä¼˜ç‚¹
- åŸºäºBootstrapUIçš„swaggeræ”¯æŒæŒ‡å®šform-dataæˆ–x-www-form-urlencoded

![](img/SwaggerBootstrapUI-01.png)

- æ”¯æŒå¤åˆ¶å•ä¸ªAPIæ–‡æ¡£å’Œå¯¼å‡ºå…¨éƒ¨APIæ–‡æ¡£
![](img/SwaggerBootstrapUI-02.png)

![](img/SwaggerBootstrapUI-03.png)

# æ•´åˆSpring Securityæ³¨æ„
åœ¨Spring Bootæ•´åˆSpring Securityå’ŒSwaggerçš„æ—¶å€™ï¼Œéœ€è¦é…ç½®æ‹¦æˆªçš„è·¯å¾„å’Œæ”¾è¡Œçš„è·¯å¾„ï¼Œæ³¨æ„æ˜¯æ”¾è¡Œä»¥ä¸‹å‡ ä¸ªè·¯å¾„ã€‚

```java
.antMatchers("/swagger**/**").permitAll()
.antMatchers("/webjars/**").permitAll()
.antMatchers("/v2/**").permitAll()
.antMatchers("/doc.html").permitAll() // å¦‚æœä½ ç”¨äº†bootstarpçš„Swagger UIç•Œé¢ï¼ŒåŠ ä¸€ä¸ªè¿™ä¸ªã€‚
```

# å¯¹äºtokençš„å¤„ç†
åœ¨swaggerä¸­åªæ”¯æŒäº†ç®€å•çš„è°ƒè¯•ï¼Œä½†å¯¹äºä¸€äº›æ¥å£ï¼Œæˆ‘ä»¬æµ‹è¯•çš„æ—¶å€™å¯èƒ½éœ€è¦æŠŠtokenä¿¡æ¯å†™åˆ°headerä¸­ï¼Œç›®å‰å¥½åƒæ²¡çœ‹åˆ°å¯ä»¥è‡ªå®šä¹‰åŠ è¯·æ±‚å¤´çš„åœ°æ–¹

æ–¹æ³•ä¸€ï¼š
ã€€ã€€å¦‚æœä½¿ç”¨äº†Swagger BootstrapUIï¼Œé‚£ä¹ˆä½ å¯ä»¥åœ¨â€œæ–‡æ¡£ç®¡ç†â€ä¸­å¢åŠ å…¨å±€å‚æ•°ï¼Œè¿™åŒ…æ‹¬äº†æ·»åŠ headerå‚æ•°ã€‚

æ–¹æ³•äºŒï¼šåœ¨swaggeré…ç½®ç±»ä¸­å¢åŠ å…¨å±€å‚æ•°é…ç½®ï¼š

```java
    //å¦‚æœæœ‰é¢å¤–çš„å…¨å±€å‚æ•°ï¼Œæ¯”å¦‚è¯´è¯·æ±‚å¤´å‚æ•°ï¼Œå¯ä»¥è¿™æ ·æ·»åŠ 
        ParameterBuilder parameterBuilder = new ParameterBuilder();
        List<Parameter> parameters = new ArrayList<Parameter>();
        parameterBuilder.name("authorization").description("ä»¤ç‰Œ")
                .modelRef(new ModelRef("string")).parameterType("header").required(false).build();
        parameters.add(parameterBuilder.build());
        return new Docket(DocumentationType.SWAGGER_2)  // DocumentationType.SWAGGER_2 å›ºå®šçš„ï¼Œä»£è¡¨swagger2
                .apiInfo(apiInfo()) // ç”¨äºç”ŸæˆAPIä¿¡æ¯
                .select() // select()å‡½æ•°è¿”å›ä¸€ä¸ªApiSelectorBuilderå®ä¾‹,ç”¨æ¥æ§åˆ¶æ¥å£è¢«swaggeråšæˆæ–‡æ¡£
                .apis(RequestHandlerSelectors.basePackage("com.example.controller")) // ç”¨äºæŒ‡å®šæ‰«æå“ªä¸ªåŒ…ä¸‹çš„æ¥å£
                .paths(PathSelectors.any())// é€‰æ‹©æ‰€æœ‰çš„API,å¦‚æœä½ æƒ³åªä¸ºéƒ¨åˆ†APIç”Ÿæˆæ–‡æ¡£ï¼Œå¯ä»¥é…ç½®è¿™é‡Œ
                .build().globalOperationParameters(parameters);
```

æ–¹æ³•ä¸‰ï¼šä½¿ç”¨`@ApiImplicitParams`æ¥é¢å¤–æ ‡æ³¨ä¸€ä¸ªè¯·æ±‚å¤´å‚æ•°ï¼Œä¾‹å¦‚ï¼š

```java
 // å¦‚æœéœ€è¦é¢å¤–çš„å‚æ•°ï¼Œéæœ¬æ–¹æ³•ç”¨åˆ°ï¼Œä½†è¿‡æ»¤å™¨è¦ç”¨,ç±»ä¼¼äºæƒé™token
    @PostMapping("/login6")
    @ApiOperation(value = "å¸¦tokençš„æ¥å£",notes = "å¸¦tokençš„æ¥å£")
    @ApiImplicitParams({
            @ApiImplicitParam(name = "authorization",//å‚æ•°åå­—
                    value = "æˆæƒtoken",//å‚æ•°çš„æè¿°
                    required = true,//æ˜¯å¦å¿…é¡»ä¼ å…¥
                    paramType = "header"
            )
            ,
            @ApiImplicitParam(name = "username",//å‚æ•°åå­—
                    value = "ç”¨æˆ·å",//å‚æ•°çš„æè¿°
                    required = true,//æ˜¯å¦å¿…é¡»ä¼ å…¥
                    paramType = "query"
            )
    })
    public String login6(String username){
        return username;
    }
```
